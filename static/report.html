<!DOCTYPE html>
<html>
<body>


<button type="button" onclick="Popup()">Report</button>

<script type="text/javascript">



function Popup() {
var stili = "top=10, left=10, width=400, height=250, status=no, menubar=no, toolbar=no scrollbars=no";
var testo = window.open("", "", stili);

testo.document.write("<html>");
testo.document.write(" <head>");
testo.document.write(" <title>Report</title>");
testo.document.write(" <basefont size=2 face=Tahoma>");
testo.document.write(" </head>");
testo.document.write("<body topmargin=50>");
testo.document.write("<div align=center>Report this picture for:</div>");
testo.document.write("<form action='Report()' name='report'>");
testo.document.write("<input type='radio' id='1' name='reports' value='Inappropriate picture'>");
testo.document.write("<label>Inappropriate picture</label><br>");
testo.document.write("<input type='radio' id='2' name='reports' value='Misinformation about the place'>");
testo.document.write("<label>Misinformation about the place</label><br>");
testo.document.write("<input type='radio' id='3' name='reports' value='Violation of privacy'>");
testo.document.write("<label>Violation of privacy</label><br><br>");
testo.document.write("<input type='submit' value='Submit'>");
testo.document.write("</form>");
testo.document.write("</body>");
testo.document.write("</html>");
}

function Report() {
    var choice;

var radios = document.getElementsByName('reports');

for (var i = 0, length = radios.length; i < length; i++) {
  if (radios[i].checked) {
 
    choice = radios[i].value;

    break;
  }
}
    
console.log(choice);

    fetch('../report', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify( { 
            email: emailuser,
            report: choice 
        })
        
    })
    .then((resp) => resp.json()) // Transform the data into json
    .then(function(data) { // Here you get the data to modify as you please
    let mes = data.message;
    if (mes.localeCompare("Report created") == 0) {
        testo.document.write("<h2>Report inviato con sucesso!</h2>");
    } else {
        testo.document.write("<h2>Errore!</h2>");
    }
});
    
}




</script>
 
</body>
</html>
